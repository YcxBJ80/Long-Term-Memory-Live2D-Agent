[32m[INFO][0m [1mRunning in standard mode. For detailed debug logs, use: uv run run_server.py --verbose[0m
[32m2025-10-05 10:39:45[0m | [1mINFO    [0m | [36m__main__[0m:[36mrun[0m:[36m122[0m | Open-LLM-VTuber, version v1.2.1
[32m2025-10-05 10:39:45[0m | [1mINFO    [0m | [36mupgrade_codes.config_sync[0m:[36mbackup_user_config[0m:[36m100[0m | 正在备份 conf.yaml 到 conf.yaml.backup
[32m2025-10-05 10:39:45[0m | [1mINFO    [0m | [36m__main__[0m:[36mrun[0m:[36m149[0m | Initializing server context...
[32m2025-10-05 10:39:45[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_memu_manager[0m:[36m340[0m | memU integration enabled (base_url=%s, user=%s, agent=%s)
[32m2025-10-05 10:39:45[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36minit_live2d[0m:[36m437[0m | Initializing Live2D: mao_pro
[32m2025-10-05 10:39:45[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.live2d_model[0m:[36m_lookup_model_info[0m:[36m142[0m | Model Information Loaded.
[32m2025-10-05 10:39:45[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36minit_asr[0m:[36m447[0m | Initializing ASR: sherpa_onnx_asr
[32m2025-10-05 10:39:45[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.asr.sherpa_onnx_asr[0m:[36m__init__[0m:[36m81[0m | Sherpa-Onnx-ASR: Using cpu for inference
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36minit_tts[0m:[36m459[0m | Initializing TTS: edge_tts
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36minit_vad[0m:[36m471[0m | VAD is disabled.
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36mload_from_config[0m:[36m303[0m | Initializing shared ServerRegistry within load_from_config.
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36mload_from_config[0m:[36m307[0m | Initializing shared ToolAdapter within load_from_config.
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_mcp_components[0m:[36m120[0m | ServerRegistry initialized or referenced.
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mget_tools[0m:[36m223[0m | MC: Running dynamic tool construction for servers: ['time', 'ddg-search']
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m__init__[0m:[36m41[0m | MCPC: Initialized MCPClient instance.
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m50[0m | MCPC: Starting and connecting to server 'time'...
[32m2025-10-05 10:39:47[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m78[0m | MCPC: Failed to connect to server 'time': 'function' object is not subscriptable
[33m[1mTraceback (most recent call last):[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m178[0m, in [35m<module>[0m
    [1mrun[0m[1m([0m[1mconsole_log_level[0m[35m[1m=[0m[1mconsole_log_level[0m[1m)[0m
    [36m│                     └ [0m[36m[1m'INFO'[0m
    [36m└ [0m[36m[1m<function run at 0x16cbfd440>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m151[0m, in [35mrun[0m
    [1masyncio[0m[35m[1m.[0m[1mrun[0m[1m([0m[1mserver[0m[35m[1m.[0m[1minitialize[0m[1m([0m[1m)[0m[1m)[0m
    [36m│       │   │      └ [0m[36m[1m<function WebSocketServer.initialize at 0x16cbfcfe0>[0m
    [36m│       │   └ [0m[36m[1m<src.open_llm_vtuber.server.WebSocketServer object at 0x16ca70320>[0m
    [36m│       └ [0m[36m[1m<function run at 0x101105300>[0m
    [36m└ [0m[36m[1m<module 'asyncio' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/__init__.py'>[0m

  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           │      │   └ <coroutine object WebSocketServer.initialize at 0x16cafbdc0>
           │      └ <function Runner.run at 0x10119d300>
           └ <asyncio.runners.Runner object at 0x16ce0ad80>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<WebSocketServer.initialize() running at /Users/yangchengxuan/Desktop/PROJECTS/Live2Document...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101196e80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x16ce0ad80>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101196de0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10119cc20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ede5c0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mserver.py[0m", line [33m154[0m, in [35minitialize[0m
    [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mdefault_context_cache[0m[35m[1m.[0m[1mload_from_config[0m[1m([0m[1mself[0m[35m[1m.[0m[1mconfig[0m[1m)[0m
    [36m      │    │                     │                │    └ [0m[36m[1mConfig(system_config=SystemConfig(conf_version='v1.2.1', host='localhost', port=12393, config_alts_dir='characters', tool_pro...[0m
    [36m      │    │                     │                └ [0m[36m[1m<src.open_llm_vtuber.server.WebSocketServer object at 0x16ca70320>[0m
    [36m      │    │                     └ [0m[36m[1m<function ServiceContext.load_from_config at 0x16c9ad260>[0m
    [36m      │    └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16c922cf0>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.server.WebSocketServer object at 0x16ca70320>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m311[0m, in [35mload_from_config[0m
    [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_init_mcp_components[0m[1m([0m
    [36m      │    └ [0m[36m[1m<function ServiceContext._init_mcp_components at 0x16c9ace00>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16c922cf0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m135[0m, in [35m_init_mcp_components[0m
    [1m)[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mtool_adapter[0m[35m[1m.[0m[1mget_tools[0m[1m([0m[1menabled_servers[0m[1m)[0m
    [36m          │    │            │         └ [0m[36m[1m['time', 'ddg-search'][0m
    [36m          │    │            └ [0m[36m[1m<function ToolAdapter.get_tools at 0x126a693a0>[0m
    [36m          │    └ [0m[36m[1m<src.open_llm_vtuber.mcpp.tool_adapter.ToolAdapter object at 0x16cec9ac0>[0m
    [36m          └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16c922cf0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mtool_adapter.py[0m", line [33m226[0m, in [35mget_tools[0m
    [1mservers_info[0m[1m,[0m [1mformatted_tools_dict[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mget_server_and_tool_info[0m[1m([0m
    [36m                                           │    └ [0m[36m[1m<function ToolAdapter.get_server_and_tool_info at 0x126a691c0>[0m
    [36m                                           └ [0m[36m[1m<src.open_llm_vtuber.mcpp.tool_adapter.ToolAdapter object at 0x16cec9ac0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mtool_adapter.py[0m", line [33m44[0m, in [35mget_server_and_tool_info[0m
    [1mtools[0m [35m[1m=[0m [35m[1mawait[0m [1mclient[0m[35m[1m.[0m[1mlist_tools[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m              │      │          └ [0m[36m[1m'time'[0m
    [36m              │      └ [0m[36m[1m<function MCPClient.list_tools at 0x126777a60>[0m
    [36m              └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x16da7e1e0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m93[0m, in [35mlist_tools[0m
    [1msession[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_ensure_server_running_and_get_session[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m                │    │                                      └ [0m[36m[1m'time'[0m
    [36m                │    └ [0m[36m[1m<function MCPClient._ensure_server_running_and_get_session at 0x1261174c0>[0m
    [36m                └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x16da7e1e0>[0m

> File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m72[0m, in [35m_ensure_server_running_and_get_session[0m
    [35m[1mawait[0m [1msession[0m[35m[1m.[0m[1minitialize[0m[1m([0m[1m)[0m
    [36m      │       └ [0m[36m[1m<function ClientSession.initialize at 0x126776d40>[0m
    [36m      └ [0m[36m[1m<mcp.client.session.ClientSession object at 0x16daa5eb0>[0m

  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/client/session.py", line 151, in initialize
    result = await self.send_request(
                   │    └ <function BaseSession.send_request at 0x126775da0>
                   └ <mcp.client.session.ClientSession object at 0x16daa5eb0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/shared/session.py", line 239, in send_request
    response_stream, response_stream_reader = anyio.create_memory_object_stream[JSONRPCResponse | JSONRPCError](1)
                                              │     │                           │                 └ <class 'mcp.types.JSONRPCError'>
                                              │     │                           └ <class 'mcp.types.JSONRPCResponse'>
                                              │     └ <function create_memory_object_stream at 0x1024c6ac0>
                                              └ <module 'anyio' from '/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/anyio/__init__.py'>

[31m[1mTypeError[0m:[1m 'function' object is not subscriptable[0m
[32m2025-10-05 10:39:47[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mget_server_and_tool_info[0m:[36m64[0m | MC: Failed to get info for server 'time': MCPC: Failed to connect to server 'time'.
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m50[0m | MCPC: Starting and connecting to server 'ddg-search'...
[32m2025-10-05 10:39:47[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m78[0m | MCPC: Failed to connect to server 'ddg-search': 'function' object is not subscriptable
[33m[1mTraceback (most recent call last):[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m178[0m, in [35m<module>[0m
    [1mrun[0m[1m([0m[1mconsole_log_level[0m[35m[1m=[0m[1mconsole_log_level[0m[1m)[0m
    [36m│                     └ [0m[36m[1m'INFO'[0m
    [36m└ [0m[36m[1m<function run at 0x16cbfd440>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m151[0m, in [35mrun[0m
    [1masyncio[0m[35m[1m.[0m[1mrun[0m[1m([0m[1mserver[0m[35m[1m.[0m[1minitialize[0m[1m([0m[1m)[0m[1m)[0m
    [36m│       │   │      └ [0m[36m[1m<function WebSocketServer.initialize at 0x16cbfcfe0>[0m
    [36m│       │   └ [0m[36m[1m<src.open_llm_vtuber.server.WebSocketServer object at 0x16ca70320>[0m
    [36m│       └ [0m[36m[1m<function run at 0x101105300>[0m
    [36m└ [0m[36m[1m<module 'asyncio' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/__init__.py'>[0m

  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           │      │   └ <coroutine object WebSocketServer.initialize at 0x16cafbdc0>
           │      └ <function Runner.run at 0x10119d300>
           └ <asyncio.runners.Runner object at 0x16ce0ad80>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<WebSocketServer.initialize() running at /Users/yangchengxuan/Desktop/PROJECTS/Live2Document...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101196e80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x16ce0ad80>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101196de0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10119cc20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ede5c0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mserver.py[0m", line [33m154[0m, in [35minitialize[0m
    [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mdefault_context_cache[0m[35m[1m.[0m[1mload_from_config[0m[1m([0m[1mself[0m[35m[1m.[0m[1mconfig[0m[1m)[0m
    [36m      │    │                     │                │    └ [0m[36m[1mConfig(system_config=SystemConfig(conf_version='v1.2.1', host='localhost', port=12393, config_alts_dir='characters', tool_pro...[0m
    [36m      │    │                     │                └ [0m[36m[1m<src.open_llm_vtuber.server.WebSocketServer object at 0x16ca70320>[0m
    [36m      │    │                     └ [0m[36m[1m<function ServiceContext.load_from_config at 0x16c9ad260>[0m
    [36m      │    └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16c922cf0>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.server.WebSocketServer object at 0x16ca70320>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m311[0m, in [35mload_from_config[0m
    [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_init_mcp_components[0m[1m([0m
    [36m      │    └ [0m[36m[1m<function ServiceContext._init_mcp_components at 0x16c9ace00>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16c922cf0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m135[0m, in [35m_init_mcp_components[0m
    [1m)[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mtool_adapter[0m[35m[1m.[0m[1mget_tools[0m[1m([0m[1menabled_servers[0m[1m)[0m
    [36m          │    │            │         └ [0m[36m[1m['time', 'ddg-search'][0m
    [36m          │    │            └ [0m[36m[1m<function ToolAdapter.get_tools at 0x126a693a0>[0m
    [36m          │    └ [0m[36m[1m<src.open_llm_vtuber.mcpp.tool_adapter.ToolAdapter object at 0x16cec9ac0>[0m
    [36m          └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16c922cf0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mtool_adapter.py[0m", line [33m226[0m, in [35mget_tools[0m
    [1mservers_info[0m[1m,[0m [1mformatted_tools_dict[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mget_server_and_tool_info[0m[1m([0m
    [36m                                           │    └ [0m[36m[1m<function ToolAdapter.get_server_and_tool_info at 0x126a691c0>[0m
    [36m                                           └ [0m[36m[1m<src.open_llm_vtuber.mcpp.tool_adapter.ToolAdapter object at 0x16cec9ac0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mtool_adapter.py[0m", line [33m44[0m, in [35mget_server_and_tool_info[0m
    [1mtools[0m [35m[1m=[0m [35m[1mawait[0m [1mclient[0m[35m[1m.[0m[1mlist_tools[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m              │      │          └ [0m[36m[1m'ddg-search'[0m
    [36m              │      └ [0m[36m[1m<function MCPClient.list_tools at 0x126777a60>[0m
    [36m              └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x16da7e1e0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m93[0m, in [35mlist_tools[0m
    [1msession[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_ensure_server_running_and_get_session[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m                │    │                                      └ [0m[36m[1m'ddg-search'[0m
    [36m                │    └ [0m[36m[1m<function MCPClient._ensure_server_running_and_get_session at 0x1261174c0>[0m
    [36m                └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x16da7e1e0>[0m

> File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m72[0m, in [35m_ensure_server_running_and_get_session[0m
    [35m[1mawait[0m [1msession[0m[35m[1m.[0m[1minitialize[0m[1m([0m[1m)[0m
    [36m      │       └ [0m[36m[1m<function ClientSession.initialize at 0x126776d40>[0m
    [36m      └ [0m[36m[1m<mcp.client.session.ClientSession object at 0x16daa72c0>[0m

  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/client/session.py", line 151, in initialize
    result = await self.send_request(
                   │    └ <function BaseSession.send_request at 0x126775da0>
                   └ <mcp.client.session.ClientSession object at 0x16daa72c0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/shared/session.py", line 239, in send_request
    response_stream, response_stream_reader = anyio.create_memory_object_stream[JSONRPCResponse | JSONRPCError](1)
                                              │     │                           │                 └ <class 'mcp.types.JSONRPCError'>
                                              │     │                           └ <class 'mcp.types.JSONRPCResponse'>
                                              │     └ <function create_memory_object_stream at 0x1024c6ac0>
                                              └ <module 'anyio' from '/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/anyio/__init__.py'>

[31m[1mTypeError[0m:[1m 'function' object is not subscriptable[0m
[32m2025-10-05 10:39:47[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mget_server_and_tool_info[0m:[36m64[0m | MC: Failed to get info for server 'ddg-search': MCPC: Failed to connect to server 'ddg-search'.
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36maclose[0m:[36m159[0m | MCPC: Closing client instance and 0 active connections...
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36maclose[0m:[36m166[0m | MCPC: Client instance closed.
[32m2025-10-05 10:39:47[0m | [33m[1mWARNING [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mconstruct_mcp_prompt_string[0m:[36m102[0m | MC: No tool info available for server 'time', skipping in prompt.
[32m2025-10-05 10:39:47[0m | [33m[1mWARNING [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mconstruct_mcp_prompt_string[0m:[36m102[0m | MC: No tool info available for server 'ddg-search', skipping in prompt.
[32m2025-10-05 10:39:47[0m | [33m[1mWARNING [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mformat_tools_for_api[0m:[36m145[0m | MC: Cannot format tools for API, input dictionary is empty.
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mget_tools[0m:[36m231[0m | MC: Dynamic tool construction complete.
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_mcp_components[0m:[36m138[0m | Dynamically generated MCP prompt string (length: 0).
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_mcp_components[0m:[36m141[0m | Dynamically formatted tools - OpenAI: 0, Claude: 0.
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m__init__[0m:[36m41[0m | MCPC: Initialized MCPClient instance.
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m50[0m | MCPC: Starting and connecting to server 'time'...
[32m2025-10-05 10:39:47[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m78[0m | MCPC: Failed to connect to server 'time': 'function' object is not subscriptable
[33m[1mTraceback (most recent call last):[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m178[0m, in [35m<module>[0m
    [1mrun[0m[1m([0m[1mconsole_log_level[0m[35m[1m=[0m[1mconsole_log_level[0m[1m)[0m
    [36m│                     └ [0m[36m[1m'INFO'[0m
    [36m└ [0m[36m[1m<function run at 0x16cbfd440>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m151[0m, in [35mrun[0m
    [1masyncio[0m[35m[1m.[0m[1mrun[0m[1m([0m[1mserver[0m[35m[1m.[0m[1minitialize[0m[1m([0m[1m)[0m[1m)[0m
    [36m│       │   │      └ [0m[36m[1m<function WebSocketServer.initialize at 0x16cbfcfe0>[0m
    [36m│       │   └ [0m[36m[1m<src.open_llm_vtuber.server.WebSocketServer object at 0x16ca70320>[0m
    [36m│       └ [0m[36m[1m<function run at 0x101105300>[0m
    [36m└ [0m[36m[1m<module 'asyncio' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/__init__.py'>[0m

  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           │      │   └ <coroutine object WebSocketServer.initialize at 0x16cafbdc0>
           │      └ <function Runner.run at 0x10119d300>
           └ <asyncio.runners.Runner object at 0x16ce0ad80>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<WebSocketServer.initialize() running at /Users/yangchengxuan/Desktop/PROJECTS/Live2Document...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101196e80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x16ce0ad80>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101196de0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10119cc20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ede5c0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mserver.py[0m", line [33m154[0m, in [35minitialize[0m
    [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mdefault_context_cache[0m[35m[1m.[0m[1mload_from_config[0m[1m([0m[1mself[0m[35m[1m.[0m[1mconfig[0m[1m)[0m
    [36m      │    │                     │                │    └ [0m[36m[1mConfig(system_config=SystemConfig(conf_version='v1.2.1', host='localhost', port=12393, config_alts_dir='characters', tool_pro...[0m
    [36m      │    │                     │                └ [0m[36m[1m<src.open_llm_vtuber.server.WebSocketServer object at 0x16ca70320>[0m
    [36m      │    │                     └ [0m[36m[1m<function ServiceContext.load_from_config at 0x16c9ad260>[0m
    [36m      │    └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16c922cf0>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.server.WebSocketServer object at 0x16ca70320>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m311[0m, in [35mload_from_config[0m
    [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_init_mcp_components[0m[1m([0m
    [36m      │    └ [0m[36m[1m<function ServiceContext._init_mcp_components at 0x16c9ace00>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16c922cf0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m147[0m, in [35m_init_mcp_components[0m
    [1m_[0m[1m,[0m [1mraw_tools_dict[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mtool_adapter[0m[35m[1m.[0m[1mget_server_and_tool_info[0m[1m([0m
    [36m                          │    │            └ [0m[36m[1m<function ToolAdapter.get_server_and_tool_info at 0x126a691c0>[0m
    [36m                          │    └ [0m[36m[1m<src.open_llm_vtuber.mcpp.tool_adapter.ToolAdapter object at 0x16cec9ac0>[0m
    [36m                          └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16c922cf0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mtool_adapter.py[0m", line [33m44[0m, in [35mget_server_and_tool_info[0m
    [1mtools[0m [35m[1m=[0m [35m[1mawait[0m [1mclient[0m[35m[1m.[0m[1mlist_tools[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m              │      │          └ [0m[36m[1m'time'[0m
    [36m              │      └ [0m[36m[1m<function MCPClient.list_tools at 0x126777a60>[0m
    [36m              └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x16da1e840>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m93[0m, in [35mlist_tools[0m
    [1msession[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_ensure_server_running_and_get_session[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m                │    │                                      └ [0m[36m[1m'time'[0m
    [36m                │    └ [0m[36m[1m<function MCPClient._ensure_server_running_and_get_session at 0x1261174c0>[0m
    [36m                └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x16da1e840>[0m

> File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m72[0m, in [35m_ensure_server_running_and_get_session[0m
    [35m[1mawait[0m [1msession[0m[35m[1m.[0m[1minitialize[0m[1m([0m[1m)[0m
    [36m      │       └ [0m[36m[1m<function ClientSession.initialize at 0x126776d40>[0m
    [36m      └ [0m[36m[1m<mcp.client.session.ClientSession object at 0x16daa6990>[0m

  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/client/session.py", line 151, in initialize
    result = await self.send_request(
                   │    └ <function BaseSession.send_request at 0x126775da0>
                   └ <mcp.client.session.ClientSession object at 0x16daa6990>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/shared/session.py", line 239, in send_request
    response_stream, response_stream_reader = anyio.create_memory_object_stream[JSONRPCResponse | JSONRPCError](1)
                                              │     │                           │                 └ <class 'mcp.types.JSONRPCError'>
                                              │     │                           └ <class 'mcp.types.JSONRPCResponse'>
                                              │     └ <function create_memory_object_stream at 0x1024c6ac0>
                                              └ <module 'anyio' from '/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/anyio/__init__.py'>

[31m[1mTypeError[0m:[1m 'function' object is not subscriptable[0m
[32m2025-10-05 10:39:47[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mget_server_and_tool_info[0m:[36m64[0m | MC: Failed to get info for server 'time': MCPC: Failed to connect to server 'time'.
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m50[0m | MCPC: Starting and connecting to server 'ddg-search'...
[32m2025-10-05 10:39:47[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m78[0m | MCPC: Failed to connect to server 'ddg-search': 'function' object is not subscriptable
[33m[1mTraceback (most recent call last):[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m178[0m, in [35m<module>[0m
    [1mrun[0m[1m([0m[1mconsole_log_level[0m[35m[1m=[0m[1mconsole_log_level[0m[1m)[0m
    [36m│                     └ [0m[36m[1m'INFO'[0m
    [36m└ [0m[36m[1m<function run at 0x16cbfd440>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m151[0m, in [35mrun[0m
    [1masyncio[0m[35m[1m.[0m[1mrun[0m[1m([0m[1mserver[0m[35m[1m.[0m[1minitialize[0m[1m([0m[1m)[0m[1m)[0m
    [36m│       │   │      └ [0m[36m[1m<function WebSocketServer.initialize at 0x16cbfcfe0>[0m
    [36m│       │   └ [0m[36m[1m<src.open_llm_vtuber.server.WebSocketServer object at 0x16ca70320>[0m
    [36m│       └ [0m[36m[1m<function run at 0x101105300>[0m
    [36m└ [0m[36m[1m<module 'asyncio' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/__init__.py'>[0m

  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           │      │   └ <coroutine object WebSocketServer.initialize at 0x16cafbdc0>
           │      └ <function Runner.run at 0x10119d300>
           └ <asyncio.runners.Runner object at 0x16ce0ad80>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<WebSocketServer.initialize() running at /Users/yangchengxuan/Desktop/PROJECTS/Live2Document...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101196e80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x16ce0ad80>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101196de0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10119cc20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ede5c0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mserver.py[0m", line [33m154[0m, in [35minitialize[0m
    [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mdefault_context_cache[0m[35m[1m.[0m[1mload_from_config[0m[1m([0m[1mself[0m[35m[1m.[0m[1mconfig[0m[1m)[0m
    [36m      │    │                     │                │    └ [0m[36m[1mConfig(system_config=SystemConfig(conf_version='v1.2.1', host='localhost', port=12393, config_alts_dir='characters', tool_pro...[0m
    [36m      │    │                     │                └ [0m[36m[1m<src.open_llm_vtuber.server.WebSocketServer object at 0x16ca70320>[0m
    [36m      │    │                     └ [0m[36m[1m<function ServiceContext.load_from_config at 0x16c9ad260>[0m
    [36m      │    └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16c922cf0>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.server.WebSocketServer object at 0x16ca70320>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m311[0m, in [35mload_from_config[0m
    [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_init_mcp_components[0m[1m([0m
    [36m      │    └ [0m[36m[1m<function ServiceContext._init_mcp_components at 0x16c9ace00>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16c922cf0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m147[0m, in [35m_init_mcp_components[0m
    [1m_[0m[1m,[0m [1mraw_tools_dict[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mtool_adapter[0m[35m[1m.[0m[1mget_server_and_tool_info[0m[1m([0m
    [36m                          │    │            └ [0m[36m[1m<function ToolAdapter.get_server_and_tool_info at 0x126a691c0>[0m
    [36m                          │    └ [0m[36m[1m<src.open_llm_vtuber.mcpp.tool_adapter.ToolAdapter object at 0x16cec9ac0>[0m
    [36m                          └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16c922cf0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mtool_adapter.py[0m", line [33m44[0m, in [35mget_server_and_tool_info[0m
    [1mtools[0m [35m[1m=[0m [35m[1mawait[0m [1mclient[0m[35m[1m.[0m[1mlist_tools[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m              │      │          └ [0m[36m[1m'ddg-search'[0m
    [36m              │      └ [0m[36m[1m<function MCPClient.list_tools at 0x126777a60>[0m
    [36m              └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x16da1e840>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m93[0m, in [35mlist_tools[0m
    [1msession[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_ensure_server_running_and_get_session[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m                │    │                                      └ [0m[36m[1m'ddg-search'[0m
    [36m                │    └ [0m[36m[1m<function MCPClient._ensure_server_running_and_get_session at 0x1261174c0>[0m
    [36m                └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x16da1e840>[0m

> File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m72[0m, in [35m_ensure_server_running_and_get_session[0m
    [35m[1mawait[0m [1msession[0m[35m[1m.[0m[1minitialize[0m[1m([0m[1m)[0m
    [36m      │       └ [0m[36m[1m<function ClientSession.initialize at 0x126776d40>[0m
    [36m      └ [0m[36m[1m<mcp.client.session.ClientSession object at 0x16daa7830>[0m

  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/client/session.py", line 151, in initialize
    result = await self.send_request(
                   │    └ <function BaseSession.send_request at 0x126775da0>
                   └ <mcp.client.session.ClientSession object at 0x16daa7830>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/shared/session.py", line 239, in send_request
    response_stream, response_stream_reader = anyio.create_memory_object_stream[JSONRPCResponse | JSONRPCError](1)
                                              │     │                           │                 └ <class 'mcp.types.JSONRPCError'>
                                              │     │                           └ <class 'mcp.types.JSONRPCResponse'>
                                              │     └ <function create_memory_object_stream at 0x1024c6ac0>
                                              └ <module 'anyio' from '/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/anyio/__init__.py'>

[31m[1mTypeError[0m:[1m 'function' object is not subscriptable[0m
[32m2025-10-05 10:39:47[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mget_server_and_tool_info[0m:[36m64[0m | MC: Failed to get info for server 'ddg-search': MCPC: Failed to connect to server 'ddg-search'.
[32m2025-10-05 10:39:47[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36maclose[0m:[36m159[0m | MCPC: Closing client instance and 0 active connections...
[32m2025-10-05 10:39:48[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36maclose[0m:[36m166[0m | MCPC: Client instance closed.
[32m2025-10-05 10:39:48[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.tool_manager[0m:[36m__init__[0m:[36m28[0m | ToolManager initialized with 0 OpenAI tools and 0 Claude tools.
[32m2025-10-05 10:39:48[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_mcp_components[0m:[36m155[0m | ToolManager initialized with dynamically fetched tools.
[32m2025-10-05 10:39:48[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m__init__[0m:[36m41[0m | MCPC: Initialized MCPClient instance.
[32m2025-10-05 10:39:48[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_mcp_components[0m:[36m170[0m | MCPClient initialized for this session.
[32m2025-10-05 10:39:48[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_mcp_components[0m:[36m180[0m | ToolExecutor initialized for this session.
[32m2025-10-05 10:39:48[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_mcp_components[0m:[36m187[0m | StreamJSONDetector initialized for this session.
[32m2025-10-05 10:39:48[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36minit_agent[0m:[36m488[0m | Initializing Agent: basic_memory_agent
[32m2025-10-05 10:39:48[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.agent.agent_factory[0m:[36mcreate_agent[0m:[36m37[0m | Initializing agent: basic_memory_agent
[32m2025-10-05 10:39:48[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.agent.stateless_llm_factory[0m:[36mcreate_llm[0m:[36m23[0m | Initializing LLM: lmstudio_llm
[32m2025-10-05 10:39:48[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.agent.stateless_llm.openai_compatible_llm[0m:[36m__init__[0m:[36m56[0m | Initialized AsyncLLM with the parameters: http://127.0.0.1:1234/v1, qwen3-30b-a3b-2507
[32m2025-10-05 10:39:48[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.agent.agents.basic_memory_agent[0m:[36m__init__[0m:[36m112[0m | BasicMemoryAgent initialized.
[32m2025-10-05 10:39:48[0m | [1mINFO    [0m | [36m__main__[0m:[36mrun[0m:[36m152[0m | Server context initialized successfully.
[32m2025-10-05 10:39:48[0m | [1mINFO    [0m | [36m__main__[0m:[36mrun[0m:[36m158[0m | Starting server on localhost:12393
INFO:     Started server process [35480]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://localhost:12393 (Press CTRL+C to quit)
INFO:     ::1:58257 - "GET / HTTP/1.1" 200 OK
INFO:     ::1:58273 - "GET / HTTP/1.1" 304 Not Modified
INFO:     ('127.0.0.1', 58275) - "WebSocket /client-ws" [accepted]
[32m2025-10-05 10:40:25[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_mcp_components[0m:[36m120[0m | ServerRegistry initialized or referenced.
[32m2025-10-05 10:40:25[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mget_tools[0m:[36m223[0m | MC: Running dynamic tool construction for servers: ['time', 'ddg-search']
[32m2025-10-05 10:40:25[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m__init__[0m:[36m41[0m | MCPC: Initialized MCPClient instance.
[32m2025-10-05 10:40:25[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m50[0m | MCPC: Starting and connecting to server 'time'...
INFO:     connection open
[32m2025-10-05 10:40:25[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m78[0m | MCPC: Failed to connect to server 'time': 'function' object is not subscriptable
[33m[1mTraceback (most recent call last):[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m178[0m, in [35m<module>[0m
    [1mrun[0m[1m([0m[1mconsole_log_level[0m[35m[1m=[0m[1mconsole_log_level[0m[1m)[0m
    [36m│                     └ [0m[36m[1m'INFO'[0m
    [36m└ [0m[36m[1m<function run at 0x16cbfd440>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m159[0m, in [35mrun[0m
    [1muvicorn[0m[35m[1m.[0m[1mrun[0m[1m([0m
    [36m│       └ [0m[36m[1m<function run at 0x1016cb240>[0m
    [36m└ [0m[36m[1m<module 'uvicorn' from '/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/__init__.py'>[0m

  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x1022a51c0>
    └ <uvicorn.server.Server object at 0x16daa7f50>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1022a5260>
           │       │   └ <uvicorn.server.Server object at 0x16daa7f50>
           │       └ <function run at 0x101105300>
           └ <module 'asyncio' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x16da37a40>
           │      └ <function Runner.run at 0x10119d300>
           └ <asyncio.runners.Runner object at 0x16cb61c40>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-20' coro=<Server.serve() running at /Users/yangchengxuan/Library/Python/3.12/lib/python/site-package...
           │    │     └ <cyfunction Loop.run_until_complete at 0x311070fb0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x16cb61c40>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/protocols/websockets/websockets_impl.py", line 247, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)
                   │    │   │    │      │    │             │    └ <function WebSocketProtocol.asgi_send at 0x315c20220>
                   │    │   │    │      │    │             └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
                   │    │   │    │      │    └ <function WebSocketProtocol.asgi_receive at 0x315c202c0>
                   │    │   │    │      └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
                   │    │   │    └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                   │    │   └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
                   │    └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16daa7350>
                   └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
                 │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
                 │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                 │    └ <fastapi.applications.FastAPI object at 0x16cb61520>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16daa7350>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
                           │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
                           └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │    │                │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │                └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x311040ad0>
          └ <fastapi.applications.FastAPI object at 0x16cb61520>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/middleware/errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x315c09820>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x311040ad0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/middleware/cors.py", line 77, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x315c09850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x315c09820>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │                            │    │    │     │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │                            │    │    │     └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │                            │    │    └ <starlette.websockets.WebSocket object at 0x315c55bb0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x315c097c0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x315c09850>
          └ <function wrap_app_handling_exceptions at 0x105bbb060>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x315c097c0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <fastapi.routing.APIRouter object at 0x16cbc66f0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x315c097c0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │    │                │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │                └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x16cbc66f0>>
          └ <fastapi.routing.APIRouter object at 0x16cbc66f0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │     │      │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │     │      └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │     └ <function WebSocketRoute.handle at 0x105be8a40>
          └ APIWebSocketRoute(path='/client-ws', name='websocket_endpoint')
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/routing.py", line 364, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <function websocket_session.<locals>.app at 0x16cbfda80>
          └ APIWebSocketRoute(path='/client-ws', name='websocket_endpoint')
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/routing.py", line 149, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │                            │    │        │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │                            │    │        └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │                            │    └ <starlette.websockets.WebSocket object at 0x315c55d90>
          │                            └ <function websocket_session.<locals>.app.<locals>.app at 0x315c211c0>
          └ <function wrap_app_handling_exceptions at 0x105bbb060>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21300>
          │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          └ <function websocket_session.<locals>.app.<locals>.app at 0x315c211c0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/routing.py", line 146, in app
    await func(session)
          │    └ <starlette.websockets.WebSocket object at 0x315c55d90>
          └ <function get_websocket_app.<locals>.app at 0x16cbfdd00>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/routing.py", line 459, in app
    await dependant.call(**solved_result.values)
          │         │      │             └ {'websocket': <starlette.websockets.WebSocket object at 0x315c55d90>}
          │         │      └ SolvedDependency(values={'websocket': <starlette.websockets.WebSocket object at 0x315c55d90>}, errors=[], background_tasks=No...
          │         └ <function init_client_ws_route.<locals>.websocket_endpoint at 0x16cbfd800>
          └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], security_requ...

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mroutes.py[0m", line [33m36[0m, in [35mwebsocket_endpoint[0m
    [35m[1mawait[0m [1mws_handler[0m[35m[1m.[0m[1mhandle_new_connection[0m[1m([0m[1mwebsocket[0m[1m,[0m [1mclient_uid[0m[1m)[0m
    [36m      │          │                     │          └ [0m[36m[1m'ff1231a7-35d5-4761-bdbd-19fe22dd3b82'[0m
    [36m      │          │                     └ [0m[36m[1m<starlette.websockets.WebSocket object at 0x315c55d90>[0m
    [36m      │          └ [0m[36m[1m<function WebSocketHandler.handle_new_connection at 0x16ca29760>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.websocket_handler.WebSocketHandler object at 0x105602e40>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mwebsocket_handler.py[0m", line [33m114[0m, in [35mhandle_new_connection[0m
    [1msession_service_context[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_init_service_context[0m[1m([0m
    [36m                                │    └ [0m[36m[1m<function WebSocketHandler._init_service_context at 0x16ca29940>[0m
    [36m                                └ [0m[36m[1m<src.open_llm_vtuber.websocket_handler.WebSocketHandler object at 0x105602e40>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mwebsocket_handler.py[0m", line [33m183[0m, in [35m_init_service_context[0m
    [35m[1mawait[0m [1msession_service_context[0m[35m[1m.[0m[1mload_cache[0m[1m([0m
    [36m      │                       └ [0m[36m[1m<function ServiceContext.load_cache at 0x16c9ad1c0>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16da7e3c0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m257[0m, in [35mload_cache[0m
    [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_init_mcp_components[0m[1m([0m
    [36m      │    └ [0m[36m[1m<function ServiceContext._init_mcp_components at 0x16c9ace00>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16da7e3c0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m135[0m, in [35m_init_mcp_components[0m
    [1m)[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mtool_adapter[0m[35m[1m.[0m[1mget_tools[0m[1m([0m[1menabled_servers[0m[1m)[0m
    [36m          │    │            │         └ [0m[36m[1m['time', 'ddg-search'][0m
    [36m          │    │            └ [0m[36m[1m<function ToolAdapter.get_tools at 0x126a693a0>[0m
    [36m          │    └ [0m[36m[1m<src.open_llm_vtuber.mcpp.tool_adapter.ToolAdapter object at 0x16cec9ac0>[0m
    [36m          └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16da7e3c0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mtool_adapter.py[0m", line [33m226[0m, in [35mget_tools[0m
    [1mservers_info[0m[1m,[0m [1mformatted_tools_dict[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mget_server_and_tool_info[0m[1m([0m
    [36m                                           │    └ [0m[36m[1m<function ToolAdapter.get_server_and_tool_info at 0x126a691c0>[0m
    [36m                                           └ [0m[36m[1m<src.open_llm_vtuber.mcpp.tool_adapter.ToolAdapter object at 0x16cec9ac0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mtool_adapter.py[0m", line [33m44[0m, in [35mget_server_and_tool_info[0m
    [1mtools[0m [35m[1m=[0m [35m[1mawait[0m [1mclient[0m[35m[1m.[0m[1mlist_tools[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m              │      │          └ [0m[36m[1m'time'[0m
    [36m              │      └ [0m[36m[1m<function MCPClient.list_tools at 0x126777a60>[0m
    [36m              └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x311079670>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m93[0m, in [35mlist_tools[0m
    [1msession[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_ensure_server_running_and_get_session[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m                │    │                                      └ [0m[36m[1m'time'[0m
    [36m                │    └ [0m[36m[1m<function MCPClient._ensure_server_running_and_get_session at 0x1261174c0>[0m
    [36m                └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x311079670>[0m

> File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m72[0m, in [35m_ensure_server_running_and_get_session[0m
    [35m[1mawait[0m [1msession[0m[35m[1m.[0m[1minitialize[0m[1m([0m[1m)[0m
    [36m      │       └ [0m[36m[1m<function ClientSession.initialize at 0x126776d40>[0m
    [36m      └ [0m[36m[1m<mcp.client.session.ClientSession object at 0x315c56300>[0m

  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/client/session.py", line 151, in initialize
    result = await self.send_request(
                   │    └ <function BaseSession.send_request at 0x126775da0>
                   └ <mcp.client.session.ClientSession object at 0x315c56300>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/shared/session.py", line 239, in send_request
    response_stream, response_stream_reader = anyio.create_memory_object_stream[JSONRPCResponse | JSONRPCError](1)
                                              │     │                           │                 └ <class 'mcp.types.JSONRPCError'>
                                              │     │                           └ <class 'mcp.types.JSONRPCResponse'>
                                              │     └ <function create_memory_object_stream at 0x1024c6ac0>
                                              └ <module 'anyio' from '/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/anyio/__init__.py'>

[31m[1mTypeError[0m:[1m 'function' object is not subscriptable[0m
[32m2025-10-05 10:40:25[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mget_server_and_tool_info[0m:[36m64[0m | MC: Failed to get info for server 'time': MCPC: Failed to connect to server 'time'.
[32m2025-10-05 10:40:25[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m50[0m | MCPC: Starting and connecting to server 'ddg-search'...
[32m2025-10-05 10:40:25[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m78[0m | MCPC: Failed to connect to server 'ddg-search': 'function' object is not subscriptable
[33m[1mTraceback (most recent call last):[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m178[0m, in [35m<module>[0m
    [1mrun[0m[1m([0m[1mconsole_log_level[0m[35m[1m=[0m[1mconsole_log_level[0m[1m)[0m
    [36m│                     └ [0m[36m[1m'INFO'[0m
    [36m└ [0m[36m[1m<function run at 0x16cbfd440>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m159[0m, in [35mrun[0m
    [1muvicorn[0m[35m[1m.[0m[1mrun[0m[1m([0m
    [36m│       └ [0m[36m[1m<function run at 0x1016cb240>[0m
    [36m└ [0m[36m[1m<module 'uvicorn' from '/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/__init__.py'>[0m

  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x1022a51c0>
    └ <uvicorn.server.Server object at 0x16daa7f50>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1022a5260>
           │       │   └ <uvicorn.server.Server object at 0x16daa7f50>
           │       └ <function run at 0x101105300>
           └ <module 'asyncio' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x16da37a40>
           │      └ <function Runner.run at 0x10119d300>
           └ <asyncio.runners.Runner object at 0x16cb61c40>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-20' coro=<Server.serve() running at /Users/yangchengxuan/Library/Python/3.12/lib/python/site-package...
           │    │     └ <cyfunction Loop.run_until_complete at 0x311070fb0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x16cb61c40>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/protocols/websockets/websockets_impl.py", line 247, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)
                   │    │   │    │      │    │             │    └ <function WebSocketProtocol.asgi_send at 0x315c20220>
                   │    │   │    │      │    │             └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
                   │    │   │    │      │    └ <function WebSocketProtocol.asgi_receive at 0x315c202c0>
                   │    │   │    │      └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
                   │    │   │    └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                   │    │   └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
                   │    └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16daa7350>
                   └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
                 │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
                 │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                 │    └ <fastapi.applications.FastAPI object at 0x16cb61520>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16daa7350>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
                           │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
                           └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │    │                │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │                └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x311040ad0>
          └ <fastapi.applications.FastAPI object at 0x16cb61520>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/middleware/errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x315c09820>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x311040ad0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/middleware/cors.py", line 77, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x315c09850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x315c09820>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │                            │    │    │     │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │                            │    │    │     └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │                            │    │    └ <starlette.websockets.WebSocket object at 0x315c55bb0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x315c097c0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x315c09850>
          └ <function wrap_app_handling_exceptions at 0x105bbb060>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x315c097c0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <fastapi.routing.APIRouter object at 0x16cbc66f0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x315c097c0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │    │                │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │                └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x16cbc66f0>>
          └ <fastapi.routing.APIRouter object at 0x16cbc66f0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │     │      │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │     │      └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │     └ <function WebSocketRoute.handle at 0x105be8a40>
          └ APIWebSocketRoute(path='/client-ws', name='websocket_endpoint')
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/routing.py", line 364, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <function websocket_session.<locals>.app at 0x16cbfda80>
          └ APIWebSocketRoute(path='/client-ws', name='websocket_endpoint')
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/routing.py", line 149, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │                            │    │        │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │                            │    │        └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │                            │    └ <starlette.websockets.WebSocket object at 0x315c55d90>
          │                            └ <function websocket_session.<locals>.app.<locals>.app at 0x315c211c0>
          └ <function wrap_app_handling_exceptions at 0x105bbb060>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21300>
          │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          └ <function websocket_session.<locals>.app.<locals>.app at 0x315c211c0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/routing.py", line 146, in app
    await func(session)
          │    └ <starlette.websockets.WebSocket object at 0x315c55d90>
          └ <function get_websocket_app.<locals>.app at 0x16cbfdd00>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/routing.py", line 459, in app
    await dependant.call(**solved_result.values)
          │         │      │             └ {'websocket': <starlette.websockets.WebSocket object at 0x315c55d90>}
          │         │      └ SolvedDependency(values={'websocket': <starlette.websockets.WebSocket object at 0x315c55d90>}, errors=[], background_tasks=No...
          │         └ <function init_client_ws_route.<locals>.websocket_endpoint at 0x16cbfd800>
          └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], security_requ...

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mroutes.py[0m", line [33m36[0m, in [35mwebsocket_endpoint[0m
    [35m[1mawait[0m [1mws_handler[0m[35m[1m.[0m[1mhandle_new_connection[0m[1m([0m[1mwebsocket[0m[1m,[0m [1mclient_uid[0m[1m)[0m
    [36m      │          │                     │          └ [0m[36m[1m'ff1231a7-35d5-4761-bdbd-19fe22dd3b82'[0m
    [36m      │          │                     └ [0m[36m[1m<starlette.websockets.WebSocket object at 0x315c55d90>[0m
    [36m      │          └ [0m[36m[1m<function WebSocketHandler.handle_new_connection at 0x16ca29760>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.websocket_handler.WebSocketHandler object at 0x105602e40>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mwebsocket_handler.py[0m", line [33m114[0m, in [35mhandle_new_connection[0m
    [1msession_service_context[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_init_service_context[0m[1m([0m
    [36m                                │    └ [0m[36m[1m<function WebSocketHandler._init_service_context at 0x16ca29940>[0m
    [36m                                └ [0m[36m[1m<src.open_llm_vtuber.websocket_handler.WebSocketHandler object at 0x105602e40>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mwebsocket_handler.py[0m", line [33m183[0m, in [35m_init_service_context[0m
    [35m[1mawait[0m [1msession_service_context[0m[35m[1m.[0m[1mload_cache[0m[1m([0m
    [36m      │                       └ [0m[36m[1m<function ServiceContext.load_cache at 0x16c9ad1c0>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16da7e3c0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m257[0m, in [35mload_cache[0m
    [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_init_mcp_components[0m[1m([0m
    [36m      │    └ [0m[36m[1m<function ServiceContext._init_mcp_components at 0x16c9ace00>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16da7e3c0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m135[0m, in [35m_init_mcp_components[0m
    [1m)[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mtool_adapter[0m[35m[1m.[0m[1mget_tools[0m[1m([0m[1menabled_servers[0m[1m)[0m
    [36m          │    │            │         └ [0m[36m[1m['time', 'ddg-search'][0m
    [36m          │    │            └ [0m[36m[1m<function ToolAdapter.get_tools at 0x126a693a0>[0m
    [36m          │    └ [0m[36m[1m<src.open_llm_vtuber.mcpp.tool_adapter.ToolAdapter object at 0x16cec9ac0>[0m
    [36m          └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16da7e3c0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mtool_adapter.py[0m", line [33m226[0m, in [35mget_tools[0m
    [1mservers_info[0m[1m,[0m [1mformatted_tools_dict[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mget_server_and_tool_info[0m[1m([0m
    [36m                                           │    └ [0m[36m[1m<function ToolAdapter.get_server_and_tool_info at 0x126a691c0>[0m
    [36m                                           └ [0m[36m[1m<src.open_llm_vtuber.mcpp.tool_adapter.ToolAdapter object at 0x16cec9ac0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mtool_adapter.py[0m", line [33m44[0m, in [35mget_server_and_tool_info[0m
    [1mtools[0m [35m[1m=[0m [35m[1mawait[0m [1mclient[0m[35m[1m.[0m[1mlist_tools[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m              │      │          └ [0m[36m[1m'ddg-search'[0m
    [36m              │      └ [0m[36m[1m<function MCPClient.list_tools at 0x126777a60>[0m
    [36m              └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x311079670>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m93[0m, in [35mlist_tools[0m
    [1msession[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_ensure_server_running_and_get_session[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m                │    │                                      └ [0m[36m[1m'ddg-search'[0m
    [36m                │    └ [0m[36m[1m<function MCPClient._ensure_server_running_and_get_session at 0x1261174c0>[0m
    [36m                └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x311079670>[0m

> File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m72[0m, in [35m_ensure_server_running_and_get_session[0m
    [35m[1mawait[0m [1msession[0m[35m[1m.[0m[1minitialize[0m[1m([0m[1m)[0m
    [36m      │       └ [0m[36m[1m<function ClientSession.initialize at 0x126776d40>[0m
    [36m      └ [0m[36m[1m<mcp.client.session.ClientSession object at 0x315c57e90>[0m

  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/client/session.py", line 151, in initialize
    result = await self.send_request(
                   │    └ <function BaseSession.send_request at 0x126775da0>
                   └ <mcp.client.session.ClientSession object at 0x315c57e90>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/shared/session.py", line 239, in send_request
    response_stream, response_stream_reader = anyio.create_memory_object_stream[JSONRPCResponse | JSONRPCError](1)
                                              │     │                           │                 └ <class 'mcp.types.JSONRPCError'>
                                              │     │                           └ <class 'mcp.types.JSONRPCResponse'>
                                              │     └ <function create_memory_object_stream at 0x1024c6ac0>
                                              └ <module 'anyio' from '/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/anyio/__init__.py'>

[31m[1mTypeError[0m:[1m 'function' object is not subscriptable[0m
[32m2025-10-05 10:40:25[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mget_server_and_tool_info[0m:[36m64[0m | MC: Failed to get info for server 'ddg-search': MCPC: Failed to connect to server 'ddg-search'.
[32m2025-10-05 10:40:25[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36maclose[0m:[36m159[0m | MCPC: Closing client instance and 0 active connections...
INFO:     ::1:58273 - "GET /undefined/undefined.model3.json HTTP/1.1" 404 Not Found
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36maclose[0m:[36m166[0m | MCPC: Client instance closed.
[32m2025-10-05 10:40:26[0m | [33m[1mWARNING [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mconstruct_mcp_prompt_string[0m:[36m102[0m | MC: No tool info available for server 'time', skipping in prompt.
[32m2025-10-05 10:40:26[0m | [33m[1mWARNING [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mconstruct_mcp_prompt_string[0m:[36m102[0m | MC: No tool info available for server 'ddg-search', skipping in prompt.
[32m2025-10-05 10:40:26[0m | [33m[1mWARNING [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mformat_tools_for_api[0m:[36m145[0m | MC: Cannot format tools for API, input dictionary is empty.
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mget_tools[0m:[36m231[0m | MC: Dynamic tool construction complete.
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_mcp_components[0m:[36m138[0m | Dynamically generated MCP prompt string (length: 0).
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_mcp_components[0m:[36m141[0m | Dynamically formatted tools - OpenAI: 0, Claude: 0.
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m__init__[0m:[36m41[0m | MCPC: Initialized MCPClient instance.
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m50[0m | MCPC: Starting and connecting to server 'time'...
[32m2025-10-05 10:40:26[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m78[0m | MCPC: Failed to connect to server 'time': 'function' object is not subscriptable
[33m[1mTraceback (most recent call last):[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m178[0m, in [35m<module>[0m
    [1mrun[0m[1m([0m[1mconsole_log_level[0m[35m[1m=[0m[1mconsole_log_level[0m[1m)[0m
    [36m│                     └ [0m[36m[1m'INFO'[0m
    [36m└ [0m[36m[1m<function run at 0x16cbfd440>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m159[0m, in [35mrun[0m
    [1muvicorn[0m[35m[1m.[0m[1mrun[0m[1m([0m
    [36m│       └ [0m[36m[1m<function run at 0x1016cb240>[0m
    [36m└ [0m[36m[1m<module 'uvicorn' from '/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/__init__.py'>[0m

  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x1022a51c0>
    └ <uvicorn.server.Server object at 0x16daa7f50>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1022a5260>
           │       │   └ <uvicorn.server.Server object at 0x16daa7f50>
           │       └ <function run at 0x101105300>
           └ <module 'asyncio' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x16da37a40>
           │      └ <function Runner.run at 0x10119d300>
           └ <asyncio.runners.Runner object at 0x16cb61c40>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-20' coro=<Server.serve() running at /Users/yangchengxuan/Library/Python/3.12/lib/python/site-package...
           │    │     └ <cyfunction Loop.run_until_complete at 0x311070fb0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x16cb61c40>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/protocols/websockets/websockets_impl.py", line 247, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)
                   │    │   │    │      │    │             │    └ <function WebSocketProtocol.asgi_send at 0x315c20220>
                   │    │   │    │      │    │             └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
                   │    │   │    │      │    └ <function WebSocketProtocol.asgi_receive at 0x315c202c0>
                   │    │   │    │      └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
                   │    │   │    └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                   │    │   └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
                   │    └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16daa7350>
                   └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
                 │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
                 │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                 │    └ <fastapi.applications.FastAPI object at 0x16cb61520>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16daa7350>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
                           │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
                           └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │    │                │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │                └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x311040ad0>
          └ <fastapi.applications.FastAPI object at 0x16cb61520>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/middleware/errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x315c09820>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x311040ad0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/middleware/cors.py", line 77, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x315c09850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x315c09820>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │                            │    │    │     │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │                            │    │    │     └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │                            │    │    └ <starlette.websockets.WebSocket object at 0x315c55bb0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x315c097c0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x315c09850>
          └ <function wrap_app_handling_exceptions at 0x105bbb060>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x315c097c0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <fastapi.routing.APIRouter object at 0x16cbc66f0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x315c097c0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │    │                │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │                └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x16cbc66f0>>
          └ <fastapi.routing.APIRouter object at 0x16cbc66f0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │     │      │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │     │      └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │     └ <function WebSocketRoute.handle at 0x105be8a40>
          └ APIWebSocketRoute(path='/client-ws', name='websocket_endpoint')
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/routing.py", line 364, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <function websocket_session.<locals>.app at 0x16cbfda80>
          └ APIWebSocketRoute(path='/client-ws', name='websocket_endpoint')
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/routing.py", line 149, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │                            │    │        │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │                            │    │        └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │                            │    └ <starlette.websockets.WebSocket object at 0x315c55d90>
          │                            └ <function websocket_session.<locals>.app.<locals>.app at 0x315c211c0>
          └ <function wrap_app_handling_exceptions at 0x105bbb060>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21300>
          │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          └ <function websocket_session.<locals>.app.<locals>.app at 0x315c211c0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/routing.py", line 146, in app
    await func(session)
          │    └ <starlette.websockets.WebSocket object at 0x315c55d90>
          └ <function get_websocket_app.<locals>.app at 0x16cbfdd00>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/routing.py", line 459, in app
    await dependant.call(**solved_result.values)
          │         │      │             └ {'websocket': <starlette.websockets.WebSocket object at 0x315c55d90>}
          │         │      └ SolvedDependency(values={'websocket': <starlette.websockets.WebSocket object at 0x315c55d90>}, errors=[], background_tasks=No...
          │         └ <function init_client_ws_route.<locals>.websocket_endpoint at 0x16cbfd800>
          └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], security_requ...

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mroutes.py[0m", line [33m36[0m, in [35mwebsocket_endpoint[0m
    [35m[1mawait[0m [1mws_handler[0m[35m[1m.[0m[1mhandle_new_connection[0m[1m([0m[1mwebsocket[0m[1m,[0m [1mclient_uid[0m[1m)[0m
    [36m      │          │                     │          └ [0m[36m[1m'ff1231a7-35d5-4761-bdbd-19fe22dd3b82'[0m
    [36m      │          │                     └ [0m[36m[1m<starlette.websockets.WebSocket object at 0x315c55d90>[0m
    [36m      │          └ [0m[36m[1m<function WebSocketHandler.handle_new_connection at 0x16ca29760>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.websocket_handler.WebSocketHandler object at 0x105602e40>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mwebsocket_handler.py[0m", line [33m114[0m, in [35mhandle_new_connection[0m
    [1msession_service_context[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_init_service_context[0m[1m([0m
    [36m                                │    └ [0m[36m[1m<function WebSocketHandler._init_service_context at 0x16ca29940>[0m
    [36m                                └ [0m[36m[1m<src.open_llm_vtuber.websocket_handler.WebSocketHandler object at 0x105602e40>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mwebsocket_handler.py[0m", line [33m183[0m, in [35m_init_service_context[0m
    [35m[1mawait[0m [1msession_service_context[0m[35m[1m.[0m[1mload_cache[0m[1m([0m
    [36m      │                       └ [0m[36m[1m<function ServiceContext.load_cache at 0x16c9ad1c0>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16da7e3c0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m257[0m, in [35mload_cache[0m
    [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_init_mcp_components[0m[1m([0m
    [36m      │    └ [0m[36m[1m<function ServiceContext._init_mcp_components at 0x16c9ace00>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16da7e3c0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m147[0m, in [35m_init_mcp_components[0m
    [1m_[0m[1m,[0m [1mraw_tools_dict[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mtool_adapter[0m[35m[1m.[0m[1mget_server_and_tool_info[0m[1m([0m
    [36m                          │    │            └ [0m[36m[1m<function ToolAdapter.get_server_and_tool_info at 0x126a691c0>[0m
    [36m                          │    └ [0m[36m[1m<src.open_llm_vtuber.mcpp.tool_adapter.ToolAdapter object at 0x16cec9ac0>[0m
    [36m                          └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16da7e3c0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mtool_adapter.py[0m", line [33m44[0m, in [35mget_server_and_tool_info[0m
    [1mtools[0m [35m[1m=[0m [35m[1mawait[0m [1mclient[0m[35m[1m.[0m[1mlist_tools[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m              │      │          └ [0m[36m[1m'time'[0m
    [36m              │      └ [0m[36m[1m<function MCPClient.list_tools at 0x126777a60>[0m
    [36m              └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x16ce0acc0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m93[0m, in [35mlist_tools[0m
    [1msession[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_ensure_server_running_and_get_session[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m                │    │                                      └ [0m[36m[1m'time'[0m
    [36m                │    └ [0m[36m[1m<function MCPClient._ensure_server_running_and_get_session at 0x1261174c0>[0m
    [36m                └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x16ce0acc0>[0m

> File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m72[0m, in [35m_ensure_server_running_and_get_session[0m
    [35m[1mawait[0m [1msession[0m[35m[1m.[0m[1minitialize[0m[1m([0m[1m)[0m
    [36m      │       └ [0m[36m[1m<function ClientSession.initialize at 0x126776d40>[0m
    [36m      └ [0m[36m[1m<mcp.client.session.ClientSession object at 0x315c57aa0>[0m

  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/client/session.py", line 151, in initialize
    result = await self.send_request(
                   │    └ <function BaseSession.send_request at 0x126775da0>
                   └ <mcp.client.session.ClientSession object at 0x315c57aa0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/shared/session.py", line 239, in send_request
    response_stream, response_stream_reader = anyio.create_memory_object_stream[JSONRPCResponse | JSONRPCError](1)
                                              │     │                           │                 └ <class 'mcp.types.JSONRPCError'>
                                              │     │                           └ <class 'mcp.types.JSONRPCResponse'>
                                              │     └ <function create_memory_object_stream at 0x1024c6ac0>
                                              └ <module 'anyio' from '/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/anyio/__init__.py'>

[31m[1mTypeError[0m:[1m 'function' object is not subscriptable[0m
[32m2025-10-05 10:40:26[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mget_server_and_tool_info[0m:[36m64[0m | MC: Failed to get info for server 'time': MCPC: Failed to connect to server 'time'.
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m50[0m | MCPC: Starting and connecting to server 'ddg-search'...
[32m2025-10-05 10:40:26[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m_ensure_server_running_and_get_session[0m:[36m78[0m | MCPC: Failed to connect to server 'ddg-search': 'function' object is not subscriptable
[33m[1mTraceback (most recent call last):[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m178[0m, in [35m<module>[0m
    [1mrun[0m[1m([0m[1mconsole_log_level[0m[35m[1m=[0m[1mconsole_log_level[0m[1m)[0m
    [36m│                     └ [0m[36m[1m'INFO'[0m
    [36m└ [0m[36m[1m<function run at 0x16cbfd440>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/[0m[32m[1mrun_server.py[0m", line [33m159[0m, in [35mrun[0m
    [1muvicorn[0m[35m[1m.[0m[1mrun[0m[1m([0m
    [36m│       └ [0m[36m[1m<function run at 0x1016cb240>[0m
    [36m└ [0m[36m[1m<module 'uvicorn' from '/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/__init__.py'>[0m

  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x1022a51c0>
    └ <uvicorn.server.Server object at 0x16daa7f50>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1022a5260>
           │       │   └ <uvicorn.server.Server object at 0x16daa7f50>
           │       └ <function run at 0x101105300>
           └ <module 'asyncio' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x16da37a40>
           │      └ <function Runner.run at 0x10119d300>
           └ <asyncio.runners.Runner object at 0x16cb61c40>
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-20' coro=<Server.serve() running at /Users/yangchengxuan/Library/Python/3.12/lib/python/site-package...
           │    │     └ <cyfunction Loop.run_until_complete at 0x311070fb0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x16cb61c40>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/protocols/websockets/websockets_impl.py", line 247, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)
                   │    │   │    │      │    │             │    └ <function WebSocketProtocol.asgi_send at 0x315c20220>
                   │    │   │    │      │    │             └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
                   │    │   │    │      │    └ <function WebSocketProtocol.asgi_receive at 0x315c202c0>
                   │    │   │    │      └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
                   │    │   │    └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                   │    │   └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
                   │    └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16daa7350>
                   └ <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c551f0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
                 │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
                 │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                 │    └ <fastapi.applications.FastAPI object at 0x16cb61520>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16daa7350>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
                           │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
                           └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │    │                │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │                └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x311040ad0>
          └ <fastapi.applications.FastAPI object at 0x16cb61520>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/middleware/errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x315c09820>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x311040ad0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/middleware/cors.py", line 77, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x315c09850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x315c09820>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <bound method WebSocketProtocol.asgi_send of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x315c...
          │                            │    │    │     │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │                            │    │    │     └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │                            │    │    └ <starlette.websockets.WebSocket object at 0x315c55bb0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x315c097c0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x315c09850>
          └ <function wrap_app_handling_exceptions at 0x105bbb060>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x315c097c0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <fastapi.routing.APIRouter object at 0x16cbc66f0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x315c097c0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │    │                │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │                └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x16cbc66f0>>
          └ <fastapi.routing.APIRouter object at 0x16cbc66f0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │     │      │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │     │      └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │     └ <function WebSocketRoute.handle at 0x105be8a40>
          └ APIWebSocketRoute(path='/client-ws', name='websocket_endpoint')
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/routing.py", line 364, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │    │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │    │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │    └ <function websocket_session.<locals>.app at 0x16cbfda80>
          └ APIWebSocketRoute(path='/client-ws', name='websocket_endpoint')
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/routing.py", line 149, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21080>
          │                            │    │        │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │                            │    │        └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          │                            │    └ <starlette.websockets.WebSocket object at 0x315c55d90>
          │                            └ <function websocket_session.<locals>.app.<locals>.app at 0x315c211c0>
          └ <function wrap_app_handling_exceptions at 0x105bbb060>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x315c21300>
          │   │      └ <bound method WebSocketProtocol.asgi_receive of <uvicorn.protocols.websockets.websockets_impl.WebSocketProtocol object at 0x3...
          │   └ {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          └ <function websocket_session.<locals>.app.<locals>.app at 0x315c211c0>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/routing.py", line 146, in app
    await func(session)
          │    └ <starlette.websockets.WebSocket object at 0x315c55d90>
          └ <function get_websocket_app.<locals>.app at 0x16cbfdd00>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/fastapi/routing.py", line 459, in app
    await dependant.call(**solved_result.values)
          │         │      │             └ {'websocket': <starlette.websockets.WebSocket object at 0x315c55d90>}
          │         │      └ SolvedDependency(values={'websocket': <starlette.websockets.WebSocket object at 0x315c55d90>}, errors=[], background_tasks=No...
          │         └ <function init_client_ws_route.<locals>.websocket_endpoint at 0x16cbfd800>
          └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], security_requ...

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mroutes.py[0m", line [33m36[0m, in [35mwebsocket_endpoint[0m
    [35m[1mawait[0m [1mws_handler[0m[35m[1m.[0m[1mhandle_new_connection[0m[1m([0m[1mwebsocket[0m[1m,[0m [1mclient_uid[0m[1m)[0m
    [36m      │          │                     │          └ [0m[36m[1m'ff1231a7-35d5-4761-bdbd-19fe22dd3b82'[0m
    [36m      │          │                     └ [0m[36m[1m<starlette.websockets.WebSocket object at 0x315c55d90>[0m
    [36m      │          └ [0m[36m[1m<function WebSocketHandler.handle_new_connection at 0x16ca29760>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.websocket_handler.WebSocketHandler object at 0x105602e40>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mwebsocket_handler.py[0m", line [33m114[0m, in [35mhandle_new_connection[0m
    [1msession_service_context[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_init_service_context[0m[1m([0m
    [36m                                │    └ [0m[36m[1m<function WebSocketHandler._init_service_context at 0x16ca29940>[0m
    [36m                                └ [0m[36m[1m<src.open_llm_vtuber.websocket_handler.WebSocketHandler object at 0x105602e40>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mwebsocket_handler.py[0m", line [33m183[0m, in [35m_init_service_context[0m
    [35m[1mawait[0m [1msession_service_context[0m[35m[1m.[0m[1mload_cache[0m[1m([0m
    [36m      │                       └ [0m[36m[1m<function ServiceContext.load_cache at 0x16c9ad1c0>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16da7e3c0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m257[0m, in [35mload_cache[0m
    [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_init_mcp_components[0m[1m([0m
    [36m      │    └ [0m[36m[1m<function ServiceContext._init_mcp_components at 0x16c9ace00>[0m
    [36m      └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16da7e3c0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/[0m[32m[1mservice_context.py[0m", line [33m147[0m, in [35m_init_mcp_components[0m
    [1m_[0m[1m,[0m [1mraw_tools_dict[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1mtool_adapter[0m[35m[1m.[0m[1mget_server_and_tool_info[0m[1m([0m
    [36m                          │    │            └ [0m[36m[1m<function ToolAdapter.get_server_and_tool_info at 0x126a691c0>[0m
    [36m                          │    └ [0m[36m[1m<src.open_llm_vtuber.mcpp.tool_adapter.ToolAdapter object at 0x16cec9ac0>[0m
    [36m                          └ [0m[36m[1m<src.open_llm_vtuber.service_context.ServiceContext object at 0x16da7e3c0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mtool_adapter.py[0m", line [33m44[0m, in [35mget_server_and_tool_info[0m
    [1mtools[0m [35m[1m=[0m [35m[1mawait[0m [1mclient[0m[35m[1m.[0m[1mlist_tools[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m              │      │          └ [0m[36m[1m'ddg-search'[0m
    [36m              │      └ [0m[36m[1m<function MCPClient.list_tools at 0x126777a60>[0m
    [36m              └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x16ce0acc0>[0m

  File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m93[0m, in [35mlist_tools[0m
    [1msession[0m [35m[1m=[0m [35m[1mawait[0m [1mself[0m[35m[1m.[0m[1m_ensure_server_running_and_get_session[0m[1m([0m[1mserver_name[0m[1m)[0m
    [36m                │    │                                      └ [0m[36m[1m'ddg-search'[0m
    [36m                │    └ [0m[36m[1m<function MCPClient._ensure_server_running_and_get_session at 0x1261174c0>[0m
    [36m                └ [0m[36m[1m<src.open_llm_vtuber.mcpp.mcp_client.MCPClient object at 0x16ce0acc0>[0m

> File "[32m/Users/yangchengxuan/Desktop/PROJECTS/Live2Document_4/Open-LLM-VTuber/src/open_llm_vtuber/mcpp/[0m[32m[1mmcp_client.py[0m", line [33m72[0m, in [35m_ensure_server_running_and_get_session[0m
    [35m[1mawait[0m [1msession[0m[35m[1m.[0m[1minitialize[0m[1m([0m[1m)[0m
    [36m      │       └ [0m[36m[1m<function ClientSession.initialize at 0x126776d40>[0m
    [36m      └ [0m[36m[1m<mcp.client.session.ClientSession object at 0x31669c740>[0m

  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/client/session.py", line 151, in initialize
    result = await self.send_request(
                   │    └ <function BaseSession.send_request at 0x126775da0>
                   └ <mcp.client.session.ClientSession object at 0x31669c740>
  File "/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/mcp/shared/session.py", line 239, in send_request
    response_stream, response_stream_reader = anyio.create_memory_object_stream[JSONRPCResponse | JSONRPCError](1)
                                              │     │                           │                 └ <class 'mcp.types.JSONRPCError'>
                                              │     │                           └ <class 'mcp.types.JSONRPCResponse'>
                                              │     └ <function create_memory_object_stream at 0x1024c6ac0>
                                              └ <module 'anyio' from '/Users/yangchengxuan/Library/Python/3.12/lib/python/site-packages/anyio/__init__.py'>

[31m[1mTypeError[0m:[1m 'function' object is not subscriptable[0m
[32m2025-10-05 10:40:26[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.mcpp.tool_adapter[0m:[36mget_server_and_tool_info[0m:[36m64[0m | MC: Failed to get info for server 'ddg-search': MCPC: Failed to connect to server 'ddg-search'.
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36maclose[0m:[36m159[0m | MCPC: Closing client instance and 0 active connections...
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36maclose[0m:[36m166[0m | MCPC: Client instance closed.
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.tool_manager[0m:[36m__init__[0m:[36m28[0m | ToolManager initialized with 0 OpenAI tools and 0 Claude tools.
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_mcp_components[0m:[36m155[0m | ToolManager initialized with dynamically fetched tools.
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.mcpp.mcp_client[0m:[36m__init__[0m:[36m41[0m | MCPC: Initialized MCPClient instance.
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_mcp_components[0m:[36m170[0m | MCPClient initialized for this session.
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_mcp_components[0m:[36m180[0m | ToolExecutor initialized for this session.
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.service_context[0m:[36m_init_mcp_components[0m:[36m187[0m | StreamJSONDetector initialized for this session.
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.websocket_handler[0m:[36mhandle_new_connection[0m:[36m126[0m | Connection established for client ff1231a7-35d5-4761-bdbd-19fe22dd3b82
[32m2025-10-05 10:40:26[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.agent.agents.basic_memory_agent[0m:[36mset_memory_from_history[0m:[36m193[0m | Loaded 0 messages from history.
[32m2025-10-05 10:40:34[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.conversations.single_conversation[0m:[36mprocess_single_conversation[0m:[36m55[0m | New Conversation Chain 🐧 started!
[32m2025-10-05 10:40:34[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.memory.memu_manager[0m:[36mget_client[0m:[36m40[0m | Initializing memU client ✨
[32m2025-10-05 10:40:36[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.memory.memu_client[0m:[36mretrieve_related_memories[0m:[36m106[0m | memU request failed with HTTPError: ReadTimeout: 
[32m2025-10-05 10:40:36[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.conversations.single_conversation[0m:[36mprocess_single_conversation[0m:[36m97[0m | User input: who am I
[32m2025-10-05 10:40:36[0m | [33m[1mWARNING [0m | [36msrc.open_llm_vtuber.agent.agents.basic_memory_agent[0m:[36mchat_with_memory[0m:[36m622[0m | No tools available/formatted for 'OpenAI' mode, despite MCP being enabled.
[32m2025-10-05 10:40:46[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.conversations.conversation_utils[0m:[36msend_conversation_end_signal[0m:[36m212[0m | 😎👍✅ Conversation Chain 😊 completed!
[32m2025-10-05 10:40:46[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.conversations.single_conversation[0m:[36mprocess_single_conversation[0m:[36m173[0m | AI response: You're someone who matters deeply.[neutral] I'm here to listen, understand, and walk with you through whatever you're feeling right now.
[32m2025-10-05 10:41:08[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.conversations.single_conversation[0m:[36mprocess_single_conversation[0m:[36m55[0m | New Conversation Chain 🐔 started!
[32m2025-10-05 10:41:10[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.memory.memu_client[0m:[36mretrieve_related_memories[0m:[36m106[0m | memU request failed with HTTPError: ReadTimeout: 
[32m2025-10-05 10:41:10[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.conversations.single_conversation[0m:[36mprocess_single_conversation[0m:[36m97[0m | User input: what am I learning these days
[32m2025-10-05 10:41:10[0m | [33m[1mWARNING [0m | [36msrc.open_llm_vtuber.agent.agents.basic_memory_agent[0m:[36mchat_with_memory[0m:[36m622[0m | No tools available/formatted for 'OpenAI' mode, despite MCP being enabled.
[32m2025-10-05 10:41:21[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.conversations.conversation_utils[0m:[36msend_conversation_end_signal[0m:[36m212[0m | 😎👍✅ Conversation Chain 😊 completed!
[32m2025-10-05 10:41:21[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.conversations.single_conversation[0m:[36mprocess_single_conversation[0m:[36m173[0m | AI response: You're learning to trust your own feelings.[sadness] That quiet voice inside—what it's trying to say matters.I'm here to hold space for it.
[32m2025-10-05 10:46:34[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.conversations.single_conversation[0m:[36mprocess_single_conversation[0m:[36m55[0m | New Conversation Chain 🎄 started!
[32m2025-10-05 10:46:34[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.conversations.conversation_utils[0m:[36mprocess_user_input[0m:[36m153[0m | Transcribing audio input...
[32m2025-10-05 10:46:37[0m | [31m[1mERROR   [0m | [36msrc.open_llm_vtuber.memory.memu_client[0m:[36mretrieve_related_memories[0m:[36m106[0m | memU request failed with HTTPError: ReadTimeout: 
[32m2025-10-05 10:46:37[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.conversations.single_conversation[0m:[36mprocess_single_conversation[0m:[36m97[0m | User input: What should I do.
[32m2025-10-05 10:46:37[0m | [33m[1mWARNING [0m | [36msrc.open_llm_vtuber.agent.agents.basic_memory_agent[0m:[36mchat_with_memory[0m:[36m622[0m | No tools available/formatted for 'OpenAI' mode, despite MCP being enabled.
[32m2025-10-05 10:46:45[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.conversations.conversation_utils[0m:[36msend_conversation_end_signal[0m:[36m212[0m | 😎👍✅ Conversation Chain 😊 completed!
[32m2025-10-05 10:46:45[0m | [1mINFO    [0m | [36msrc.open_llm_vtuber.conversations.single_conversation[0m:[36mprocess_single_conversation[0m:[36m173[0m | AI response: Take a slow breath.[neutral] Whatever you're feeling is valid.I'm here with you—just for this moment.
